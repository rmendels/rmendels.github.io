<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using rerddapUtils • rerddapUtils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using rerddapUtils">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rerddapUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/using-rerddapUtils.html">Using rerddapUtils</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using rerddapUtils</h1>
            
      

      <div class="hidden name"><code>using-rerddapUtils.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/" class="external-link">arrow</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'arrow'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:utils':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     timestamp</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.duckdb.org/" class="external-link">duckdb</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: DBI</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://duckdblabs.github.io/duckplyr/" class="external-link">duckplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; The <span style="color: #0000BB;">duckplyr</span> package is configured to fall back to <span style="color: #0000BB;">dplyr</span> when it encounters an</span></span>
<span><span class="co">#&gt; incompatibility. Fallback events can be collected and uploaded for analysis to</span></span>
<span><span class="co">#&gt; guide future development. By default, no data will be collected or uploaded.</span></span>
<span><span class="co">#&gt; → Run `duckplyr::fallback_sitrep()` to review the current settings.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Overwriting <span style="color: #0000BB;">dplyr</span> methods with <span style="color: #0000BB;">duckplyr</span> methods.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Turn off with `duckplyr::methods_restore()`.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'duckplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'lubridate'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:arrow':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     duration</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     date, intersect, setdiff, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cirrus.ucsd.edu/~pierce/ncdf/" class="external-link">ncdf4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rerddap/" class="external-link">rerddap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rerddapUtils</span><span class="op">)</span></span></code></pre></div>
<p><code>rerddapUtils</code> is an <span style="color:red">R</span>
package is a set of four functions desigened to work with and extend the
<code>rerddap</code> package to provide capabilities requested by users
that meet specialized needs which are better not being included in the
<code>rerddao</code> package.</p>
<p>The first function is:</p>
<ul>
<li><code>griddap_season &lt;- function(datasetx, ..., fields = 'all', stride = 1, season = NULL, fmt = "nc", url = eurl(), store = disk(), read = TRUE, callopts = list())</code></li>
</ul>
<p>which will only extract data for the period during the year defined
by ‘season’. The second function is:</p>
<ul>
<li><code>griddap_split &lt;- function(datasetx, ..., fields = 'all', stride = 1, request_split = NULL, fmt = "nc", url = eurl(), store = disk(), read = TRUE, callopts = list(), aggregate_file = NULL)</code></li>
</ul>
<p>which is designed to split a very large request into pieces defined
by ‘request_split’ and then aggregate the parts either in memory, in a
duckdb database or in a netcdf4 file. This allows for requests larger
than 2GB to be made in an appropriate manner.</p>
<p>Note that <code><a href="../reference/griddap_season.html">griddap_season()</a></code> and
<code><a href="../reference/griddap_split.html">griddap_split()</a></code> are designed to have basically the same
interface as <code>rerddao::griddap()</code>, except for one or two
extra function arguments and some arguments that are interpted
differently. In both functions the argument ‘store = disk()’ is ignored.
In <code>griddap_season</code> the ‘fmt’ argument is ignored while
‘season’ defines the days during the year to make the extract.</p>
<p>In <code>griddap_split</code> the argument ‘fmt’ defines whether the
aggregate download should be stored in memory as a dataframe, in a
duckdb database file, or in a netcdf file. For the duckdb and nectdf
options, ‘aggregate_file’ lets you define where to write the file, if
not defined it will set up a temporary file following proper <span style="color:red">R</span> guidelines and in both cases the path to the
file will be returned.</p>
<p>The other two functions are designed to make it easier to work with
projected datasets:</p>
<ul>
<li><code>latlon_to_xy &lt;- function (dataInfo, latitude, longitude, yName = 'latitude', xName = 'longitude', crs = NULL)</code></li>
</ul>
<p>which for a given dataset will convert a latitude and longitude
request into the projected coordiantes to be used in
<code>rerddao::griddap()</code>, while the fourth function:</p>
<ul>
<li><code>xy_to_latlon &lt;- function (resp, yName = 'cols', xName = 'rows', crs = NULL)</code></li>
</ul>
<p>does the reverse, given an <code>rerddao::griddap()</code> extract
will convert the projected coordinates into latitiude and longitude
values.</p>
<p>This vignette assumes familiarity with the various ‘rerddap’
functions and how to use them. More information about the various
‘rerddap’ functions can be found in the documentation for that
package.</p>
<div class="section level2">
<h2 id="extract-during-a-season---griddap_season">Extract during a season - <code>griddap_season()</code><a class="anchor" aria-label="anchor" href="#extract-during-a-season---griddap_season"></a>
</h2>
<p>The function <code><a href="../reference/griddap_season.html">griddap_season()</a></code> works exactly like the
function <code><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">rerddap::griddap</a></code> except that there is one extra
argument, “season”, which restricts the extract to the part of the year
defined by season, and also ignores several of the
<code><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">rerddap::griddap</a></code> options, as it will ignore what format to
downaod the data, and will only save to a standard
<code><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">rerddap::griddap</a></code> output structure.</p>
<p>The argument “season” is a character string such that for a given
“year”, paste0(year, ‘-’, season) produces a valid ISO datetime string.
To test “season” is properly formed, use
<code><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">lubridate::as_datetime()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">year</span> <span class="op">&lt;-</span> <span class="st">'2023'</span></span>
<span><span class="va">season</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'02-01'</span>, <span class="st">'06-01'</span><span class="op">)</span></span>
<span><span class="co"># test that "season" is defined properly</span></span>
<span><span class="va">test_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">'-'</span>, <span class="va">season</span><span class="op">)</span></span>
<span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="va">test_time</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2023-02-01 UTC" "2023-06-01 UTC"</span></span></code></pre></div>
<p>Even though the example only includes month and day, hours etc can be
included as long as the final result, when a year is appended, produces
a valid datetime.</p>
<p>As an example call and result, suppose you have a working
<code><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">rerddap::griddap()</a></code> extract given by:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wind_info</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">info</a></span><span class="op">(</span><span class="st">'erdQMekm14day'</span><span class="op">)</span></span>
<span><span class="va">extract</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">griddap</a></span><span class="op">(</span><span class="va">wind_info</span>,</span>
<span>                            time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2015-01-01'</span>,<span class="st">'2019-01-01'</span><span class="op">)</span>,</span>
<span>                            latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>                            longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">240</span><span class="op">)</span>,</span>
<span>                            fields <span class="op">=</span> <span class="st">'mod_current'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>but it is desired to restrict extract to March 1 to May 1 inclusive,
then the following modification of the above using
<code><a href="../reference/griddap_season.html">griddap_season()</a></code>produces the desired result:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wind_info</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">info</a></span><span class="op">(</span><span class="st">'erdQMekm14day'</span><span class="op">)</span></span>
<span><span class="va">season</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'03-01'</span>, <span class="st">'05-01'</span><span class="op">)</span></span>
<span><span class="va">season_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/griddap_season.html">griddap_season</a></span><span class="op">(</span><span class="va">wind_info</span>,</span>
<span> time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2015-01-01'</span>,<span class="st">'2019-01-01'</span><span class="op">)</span>,</span>
<span> latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span> longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">240</span><span class="op">)</span>,</span>
<span> fields <span class="op">=</span> <span class="st">'mod_current'</span>,</span>
<span> season <span class="op">=</span> <span class="va">season</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; info() output passed to x; setting base url to: https://upwell.pfeg.noaa.gov/erddap</span></span>
<span><span class="co">#&gt; info() output passed to x; setting base url to: https://upwell.pfeg.noaa.gov/erddap</span></span>
<span><span class="co">#&gt; info() output passed to x; setting base url to: https://upwell.pfeg.noaa.gov/erddap</span></span>
<span><span class="co">#&gt; info() output passed to x; setting base url to: https://upwell.pfeg.noaa.gov/erddap</span></span>
<span><span class="co">#&gt; info() output passed to x; setting base url to: https://upwell.pfeg.noaa.gov/erddap</span></span>
<span><span class="co">#&gt; info() output passed to x; setting base url to: https://upwell.pfeg.noaa.gov/erddap</span></span>
<span><span class="co">#&gt; info() output passed to x; setting base url to: https://upwell.pfeg.noaa.gov/erddap</span></span></code></pre></div>
<p>To see that the extract has been limited to the given season:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extract_times</span>  <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="va">season_extract</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">extract_months</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">extract_times</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">extract_months</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3 4 5</span></span></code></pre></div>
<p>Only results for months 3, 4, and 5 are included, as per the values
of “season”. May is included because the definition of “season” is
inclusive, hence May 1 will be included.</p>
</div>
<div class="section level2">
<h2 id="split-an-extract-into-parts---griddap_split">Split an extract into parts - <code>griddap_split()</code><a class="anchor" aria-label="anchor" href="#split-an-extract-into-parts---griddap_split"></a>
</h2>
<p>The function <code><a href="../reference/griddap_split.html">griddap_split()</a></code> allows to make
<code><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">rerddap::griddap()</a></code> requests that are larger than the 2GB
limit by splitting the request into parts and then combining the results
either in memory in a dataframe, in a netcdf4 file, or into a duckdb
database file. If the “in memory” option is chosen, there is no check
that there is adequate memory, so it is possible to crash both R and
your computer. The nectdf4 and duckdb options depend more on having
adequate disk space, not memory. Also, there is no check that the split
given will reduce the requests to a small enough size, that is up to the
user to estimate.</p>
<p><code><a href="../reference/griddap_split.html">griddap_split()</a></code> uses the same arguments as
<code><a href="../reference/griddap_split.html">griddap_split()</a></code> execpt that:</p>
<ul>
<li>The “store” and “read” arguments are ignored.</li>
<li>“fmt” is one of “memory”, “nc”, or “duckdb” - default “nc”</li>
<li>an added argument “split”</li>
<li>an added argument “aggregate_file” - default is to create an R
temporary file</li>
</ul>
<p>The argument “split” is a named list that defines the number of
splits in each dimension, not the values where to make the splits, and a
value must be given for each coordinate in the dataset. So for the
dataset ‘erdQMekm14day’ above, there are four coordinates, “time”,
“altitude”, “latitude” and “longitude”, to break the request into five
“time” parts and two “latitude” and “longitude” parts (if you remember
your combinatorics the original request will be broken into 20 separate
requests) use:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">request_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">5</span>, altitude <span class="op">=</span> <span class="fl">1</span>, latitude <span class="op">=</span> <span class="fl">2</span>, longitude <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Note that:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">request_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">5</span>, latitude <span class="op">=</span> <span class="fl">2</span>, longitude <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>will fail, even though “altitude” is dimension one. A value must be
given for all of the dataset coordinates.</p>
<p>“fmt” defines how the split extracts will be combined to give one
result. If fmt = “memory” then the results are combined into a usual
<code><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">rerddap::griddap()</a></code> in memory, and that structure is
returned by the function. If fmt = “nc” then the extracts wil be
combined into a netcdf4 file, and a path to the netcdf file is returned
by the function. If fmt = “duckdb” then the extracts wil be combined
into a duckdb database file, and a path to the duckdb file is returned
by the function.</p>
<p>As in the previous example suppose I had an
<code><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">rerddap::griddap()</a></code> extract:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wind_info</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">info</a></span><span class="op">(</span><span class="st">'erdQMekm14day'</span><span class="op">)</span></span>
<span><span class="va">extract</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">griddap</a></span><span class="op">(</span><span class="va">wind_info</span>,</span>
<span>                            time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2015-01-01'</span>,<span class="st">'2016-01-01'</span><span class="op">)</span>,</span>
<span>                            latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>                            longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">240</span><span class="op">)</span>,</span>
<span>                            fields <span class="op">=</span> <span class="st">'mod_current'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>which would request an extract too large for ERDDAP to fulfill (that
is not the case here so a split is not needed, but this illustrates the
usage). Then the following modifies the code to split the request and
save into a structure in memory:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">wind_info</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">info</a></span><span class="op">(</span><span class="st">'erdQMekm14day'</span><span class="op">)</span></span>
<span><span class="va">request_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">5</span>, altitude <span class="op">=</span> <span class="fl">1</span>, latitude <span class="op">=</span> <span class="fl">2</span>, longitude <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">split_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/griddap_split.html">griddap_split</a></span><span class="op">(</span><span class="va">wind_info</span>,</span>
<span> time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2015-01-01'</span>,<span class="st">'2016-01-01'</span><span class="op">)</span>,</span>
<span> latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span> longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">240</span><span class="op">)</span>,</span>
<span> fields <span class="op">=</span> <span class="st">'mod_current'</span>,</span>
<span> request_split <span class="op">=</span> <span class="va">request_split</span>,</span>
<span> fmt <span class="op">=</span> <span class="st">"memory"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">split_extract</span><span class="op">)</span></span></code></pre></div>
<p>On return, “split_extract” will contain the usual
<code><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">rerddap::griddap()</a></code> structure. Again, there is no check that
there is enough memory to do this operation, so it is possible to crash
R (or your computer) if not used carefully, but it is not unusual for
computers to have 16GB of RAM or more, so extracts a good bit larger
than 2GB can be stored in memory.</p>
<p>If instead it is desired to store the result in a netcdf4 file:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">wind_info</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">info</a></span><span class="op">(</span><span class="st">'erdQMekm14day'</span><span class="op">)</span></span>
<span><span class="va">request_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">5</span>, altitude <span class="op">=</span> <span class="fl">1</span>, latitude <span class="op">=</span> <span class="fl">2</span>, longitude <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">split_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/griddap_split.html">griddap_split</a></span><span class="op">(</span><span class="va">wind_info</span>,</span>
<span> time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2015-01-01'</span>,<span class="st">'2016-01-01'</span><span class="op">)</span>,</span>
<span> latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span> longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">240</span><span class="op">)</span>,</span>
<span> fields <span class="op">=</span> <span class="st">'mod_current'</span>,</span>
<span> request_split <span class="op">=</span> <span class="va">request_split</span>,</span>
<span> fmt <span class="op">=</span> <span class="st">"nc"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; info() output passed to x; setting base url to: https://upwell.pfeg.noaa.gov/erddap</span></span>
<span><span class="co">#&gt; info() output passed to x; setting base url to: https://upwell.pfeg.noaa.gov/erddap</span></span></code></pre></div>
<p>Since “aggregate_file” is not given, the netcdf file will be written
to a temporary space and the path to that file will be returned by the
function. The reason for this is it is bad form for an R package to
write to a user’s space without permission. To give permission to wrtie
to a file of one’s choosing, either give the full path to the file (or
if just the name is given it will be written to the present directory),
such as for the example above:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">wind_info</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">info</a></span><span class="op">(</span><span class="st">'erdQMekm14day'</span><span class="op">)</span></span>
<span><span class="va">request_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">5</span>, altitude <span class="op">=</span> <span class="fl">1</span>, latitude <span class="op">=</span> <span class="fl">2</span>, longitude <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">split_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/griddap_split.html">griddap_split</a></span><span class="op">(</span><span class="va">wind_info</span>,</span>
<span> time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2015-01-01'</span>,<span class="st">'2019-01-01'</span><span class="op">)</span>,</span>
<span> latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span> longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">240</span><span class="op">)</span>,</span>
<span> fields <span class="op">=</span> <span class="st">'mod_current'</span>,</span>
<span> request_split <span class="op">=</span> <span class="va">request_split</span>,</span>
<span> fmt <span class="op">=</span> <span class="st">"nc"</span>,</span>
<span> aggregate_file <span class="op">=</span> <span class="st">'wind_extract.nc'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>To access the data in the file, any of the various R packages that
can read netcdf4 files can be used, in particular ones that allow for
only part of the dataset to be read into memory at a time. For example
to open the result of the netcdf file created above using ‘ncdf4’ and
viewing a summary:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wind_file</span> <span class="op">&lt;-</span> <span class="fu">ncdf4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ncdf4/man/nc_open.html" class="external-link">nc_open</a></span><span class="op">(</span><span class="va">split_extract</span> <span class="op">)</span></span>
<span><span class="va">wind_file</span></span>
<span><span class="fu">ncdf4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ncdf4/man/nc_close.html" class="external-link">nc_close</a></span><span class="op">(</span><span class="va">wind_file</span><span class="op">)</span></span></code></pre></div>
<p>To make the same extract and save to a duckbb database file:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">wind_info</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">info</a></span><span class="op">(</span><span class="st">'erdQMekm14day'</span><span class="op">)</span></span>
<span><span class="va">request_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">5</span>, altitude <span class="op">=</span> <span class="fl">1</span>, latitude <span class="op">=</span> <span class="fl">2</span>, longitude <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">split_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/griddap_split.html">griddap_split</a></span><span class="op">(</span><span class="va">wind_info</span>,</span>
<span> time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2015-01-01'</span>,<span class="st">'2016-01-01'</span><span class="op">)</span>,</span>
<span> latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span> longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">240</span><span class="op">)</span>,</span>
<span> fields <span class="op">=</span> <span class="st">'mod_current'</span>,</span>
<span> request_split <span class="op">=</span> <span class="va">request_split</span>,</span>
<span> fmt <span class="op">=</span> <span class="st">"duckdb"</span>,</span>
<span> aggregate_file <span class="op">=</span> <span class="st">'wind_extract.duckdb'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>There are many tools that can used to access the duckdb database
file, among others the packages ‘dplyr’ and ‘duckplyr’ can be used:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"wind_extract.duckdb"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con_db</span>, <span class="st">"extract"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con_db</span>, shutdown<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Note that the table will always be called “extract”.</p>
<p>The default duckdb format is used because it allows for incremental
additions to the dataset on disk, so datasets can be larger than memory.
A popular format for storing data is “parquet”, or if it is desired to
encode geometry information into the data, then the “geoparquet” format.
To copy the duckdb file to parquet:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"wind_extract.duckdb"</span><span class="op">)</span></span>
<span><span class="co"># Use DuckDB's COPY command to write directly to Parquet file without loading into R</span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"COPY extract TO '%s' (FORMAT 'parquet')"</span>, <span class="st">"wind_extract.parquet"</span><span class="op">)</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbExecute.html" class="external-link">dbExecute</a></span><span class="op">(</span><span class="va">con_db</span>, <span class="va">query</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con_db</span>, shutdown<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>To write to a geoparquet file the package <code>geoarrow</code> cna
be used, which involves first adding the geocoding information - to do
so requires reading the entire data into memory so this will not work
for datasets larger than memory:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"wind_extract.duckdb"</span><span class="op">)</span></span>
<span><span class="va">wind_data</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span><span class="va">con_db</span>, <span class="st">"SELECT * FROM extract"</span><span class="op">)</span></span>
<span><span class="co"># Create a geometry column using geoarrow using latitude and longitude</span></span>
<span><span class="va">wind_data</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">wind_data</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/write_parquet.html" class="external-link">write_parquet</a></span><span class="op">(</span><span class="va">wind_data</span>,  <span class="st">"wind_extract_geo.parquet"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con_db</span>, shutdown<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The resulting parquet files are half the size of the duckdb file, or
smaller. While these examples are for writing the duckdb database to the
parquet format, similar steps can be used if the data are in tibbles,
but it may require reading the entire dataset into memory.</p>
</div>
<div class="section level2">
<h2 id="working-with-projected-datasets---latlon_to_xy-and-xy_to_latlon">Working with projected datasets - <code>latlon_to_xy()</code> and
<code>xy_to_latlon()</code><a class="anchor" aria-label="anchor" href="#working-with-projected-datasets---latlon_to_xy-and-xy_to_latlon"></a>
</h2>
<p>Extracting projected data in ERDDAP (that is not on a
latitude-longitude) grid can be difficult because most people do not
think in terms of the projection in defining the region to make an
extract, and similary once an extract has been made, it is often
desirable to know the coordinates in terms of latitude and longitude.
The functions <code><a href="../reference/latlon_to_xy.html">latlon_to_xy()</a></code> and
<code><a href="../reference/xy_to_latlon.html">xy_to_latlon()</a></code> are desigend to help with that process.</p>
<p>In both cases the functions try to determine the dataset projection
either from the dataset summary given by <code><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">rerddap::info()</a></code>
when projecting the values of a latitude-longitude bounding box, and
when an extract has been made, from the metadata in the extract. This is
done by searching for any of the terms:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>   <span class="va">proj_strings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'proj4text'</span>, <span class="st">'projection'</span>, <span class="st">'proj4string'</span>, <span class="st">'grid_mapping_epsg_code'</span>,</span>
<span>                    <span class="st">'WKT'</span>,  <span class="st">'proj_crs_code'</span>,</span>
<span>                    <span class="st">'grid_mapping_epsg_code'</span>, <span class="st">'grid_mapping_proj4'</span>,</span>
<span>                    <span class="st">'grid_mapping_proj4_params'</span>, <span class="st">'grid_mapping_proj4text'</span><span class="op">)</span></span></code></pre></div>
<p>in the metadata. If this is not found, then the user has to provide
“CRS”, which can be in any of the forms above. For example the Ice
dataset ‘nsidcG02202v4sh1day’ on the Polarwatch ERDDAP is projected. The
bounding box of interest is:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">latitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">80.</span>, <span class="fl">85.</span><span class="op">)</span></span>
<span><span class="va">longitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">170.</span>, <span class="op">-</span><span class="fl">165</span><span class="op">)</span></span></code></pre></div>
<p>then the bounding box in projected coordinates is found from:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myURL</span> <span class="op">&lt;-</span> <span class="st">'https://polarwatch.noaa.gov/erddap/'</span></span>
<span><span class="va">myInfo</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">info</a></span><span class="op">(</span><span class="st">'noaacwVIIRSn20icethickNP06Daily'</span>, url <span class="op">=</span> <span class="va">myURL</span><span class="op">)</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latlon_to_xy.html">latlon_to_xy</a></span><span class="op">(</span><span class="va">myInfo</span>,  <span class="va">longitude</span>, <span class="va">latitude</span><span class="op">)</span></span>
<span><span class="va">coords</span></span></code></pre></div>
<p>Similary, given an extract on a projected coordinate system, the
values on terms of latitude and longitude can be found by:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">889533.8</span>, <span class="op">-</span><span class="fl">469356.9</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">622858.3</span>, <span class="fl">270983.4</span><span class="op">)</span></span>
<span><span class="va">myURL</span> <span class="op">&lt;-</span> <span class="st">'https://polarwatch.noaa.gov/erddap/'</span></span>
<span><span class="va">myInfo</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/info.html" class="external-link">info</a></span><span class="op">(</span><span class="st">'noaacwVIIRSn20icethickNP06Daily'</span>, url <span class="op">=</span> <span class="va">myURL</span><span class="op">)</span></span>
<span><span class="va">proj_extract</span> <span class="op">&lt;-</span> <span class="fu">rerddap</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rerddap/reference/griddap.html" class="external-link">griddap</a></span><span class="op">(</span><span class="va">myInfo</span>,</span>
<span>                                  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2023-01-30T00:00:00Z'</span>, <span class="st">'2023-01-30T00:00:00Z'</span><span class="op">)</span>,</span>
<span>                                  rows <span class="op">=</span> <span class="va">rows</span>,</span>
<span>                                  cols <span class="op">=</span> <span class="va">cols</span>,</span>
<span>                                  fields <span class="op">=</span> <span class="st">'IceThickness'</span>,</span>
<span>                                  url <span class="op">=</span> <span class="va">myURL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xy_to_latlon.html">xy_to_latlon</a></span><span class="op">(</span><span class="va">proj_extract</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span></code></pre></div>
<p>Note that <code><a href="../reference/xy_to_latlon.html">xy_to_latlon()</a></code> will also work with the output
from the functions <code><a href="https://rdrr.io/pkg/rerddapXtracto/man/rxtracto.html" class="external-link">rerddapXtracto::rxtracto()</a></code>,
<code><a href="https://rdrr.io/pkg/rerddapXtracto/man/rxtracto_3D.html" class="external-link">rerddapXtracto::rxtracto_3D()</a></code> and
`<code><a href="https://rdrr.io/pkg/rerddapXtracto/man/rxtractogon.html" class="external-link">rerddapXtracto::rxtractogon()</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Roy Mendelssohn.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
